import{_ as $e,a as y,r as Y,o as De,c as B,b as n,A as t,p as l,z as s,E as c,j as Be,W as Le,k as f,f as i,g as Z,C as w,t as d,m as M,F as Se,d as Ue,L as S}from"./index-Ntw4s37F.js";import{m as U}from"./meeting-Yn1Lkn_b.js";const Ne={class:"meeting-management"},Re={class:"page-header"},Ee={class:"header-right"},Pe={class:"table-header"},Fe={class:"table-title"},je={class:"total-count"},Ae={class:"table-actions"},Ie={class:"meeting-title"},Ge={key:1,class:"card-view"},Oe={class:"meeting-cards"},We=["onClick"],qe={class:"card-header"},He={class:"meeting-type"},Je={class:"card-actions"},Ke={class:"card-content"},Qe={class:"meeting-title"},Xe={class:"meeting-info"},Ye={class:"info-item"},Ze={class:"info-item"},et={class:"info-item"},tt={class:"meeting-description"},lt={class:"card-footer"},nt={class:"meeting-status"},at={class:"creator-info"},ot={class:"pagination-wrapper"},st={key:0,class:"meeting-detail"},it={class:"detail-header"},dt={class:"detail-tags"},rt={class:"detail-content"},ut={class:"detail-section"},ct={class:"info-grid"},pt={class:"info-item"},_t={class:"info-item"},mt={class:"info-item"},ft={class:"info-item"},vt={class:"info-item"},gt={class:"info-item"},yt={class:"detail-section"},bt={class:"description-content"},ht={class:"detail-section"},wt={class:"agenda-content"},Ct={class:"dialog-footer"},kt={__name:"MeetingManagement",setup(xt){const N=Be(),L=y(!1),T=y("table"),z=y(!1),V=y([]),r=y(null),ee=y([]),R=y(0);y(null),y(!1),y("");const p=Y({title:"",type:null,status:null,dateRange:null}),_=Y({page:1,size:20}),v=async()=>{L.value=!0;try{const o={page:_.page,size:_.size,...p},e=await U.getMeetingList(o,localStorage.getItem("tenantId"));e.code==200?(V.value=e.data.records||[],R.value=e.data.total||0,console.log(V.value)):c.error(e.message||"加载会议列表失败")}catch(o){c.error("加载会议列表失败"),console.error(o)}finally{L.value=!1}},te=()=>{_.page=1,v()},le=()=>{Object.assign(p,{title:"",type:null,status:null,dateRange:null}),_.page=1,v()},ne=o=>{_.size=o,_.page=1,v()},ae=o=>{_.page=o,v()},oe=o=>{ee.value=o},se=()=>{N.push("/dashboard/meetings/create")},I=o=>{const e=V.value.find(g=>g.id===o);e&&(r.value=e,z.value=!0)},E=o=>{N.push(`/dashboard/meetings/edit/${o}`)},ie=o=>{N.push(`/dashboard/meetings/${o}/registrations`)},G=async(o,e)=>{switch(o){case"publish":await de(e.id);break;case"cancel":await re(e.id);break;case"top":await O(e.id,1);break;case"untop":await O(e.id,0);break;case"copy":await ue(e.id);break;case"edit":E(e.id);break;case"delete":await ce(e.id);break}},de=async o=>{try{await S.confirm("确认发布该会议吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});const e=await U.publishMeeting(o);e.code==200?(c.success("会议发布成功"),v()):c.error(e.message||"发布失败")}catch(e){e!=="cancel"&&c.error("发布失败")}},re=async o=>{try{await S.confirm("确认取消该会议吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),c.success("会议取消成功"),v()}catch(e){e!=="cancel"&&c.error("取消失败")}},O=async(o,e)=>{try{await S.confirm(e?"确认将该会议置顶吗？":"确认取消该会议置顶吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});const g=await U.topMeeting(o,e);if(g.code===200){const u=e?"置顶":"取消置顶";c.success(`${u}成功`),v()}else c.error(g.message||`${action}失败`)}catch(g){if(g!=="cancel"){const u=e?"置顶":"取消置顶";c.error(`${u}失败`)}}},ue=async o=>{try{c.success("会议复制成功"),v()}catch{c.error("复制失败")}},ce=async o=>{try{await S.confirm("确认删除该会议吗？删除后无法恢复。","提示",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"error"});const e=await U.deleteMeeting(o);e.code==200?(c.success("会议删除成功"),v()):c.error(e.message||"删除失败")}catch(e){e!=="cancel"&&c.error("删除失败")}},pe=()=>{z.value=!1,r.value=null},$=o=>{if(!o)return"-";try{let e;if(typeof o=="string"){const g=o.replace(/([+-]\d{2})$/,"$1:00");e=new Date(g)}else e=new Date(o);return isNaN(e.getTime())?(console.warn("无效的日期格式:",o),"-"):e.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(e){return console.error("日期格式化错误:",e,o),"-"}},P=o=>({tech:"primary",product:"success",training:"warning",review:"danger",team:"secondary"})[o]||"info",F=o=>({tech:"技术分享",product:"产品讨论",training:"培训学习",review:"项目评审",team:"团队建设","":"其他"})[o]||"其他",j=o=>({0:"info",1:"success",2:"danger"})[o]||"info",A=o=>({0:"草稿",1:"已发布",2:"已取消",3:"已结束",4:"进行中"})[o]||"未知";return De(()=>{v()}),(o,e)=>{const g=s("Plus"),u=s("el-icon"),m=s("el-button"),_e=s("el-input"),D=s("el-form-item"),C=s("el-option"),W=s("el-select"),me=s("el-date-picker"),fe=s("Search"),ve=s("Refresh"),ge=s("el-form"),q=s("el-card"),ye=s("List"),be=s("Grid"),H=s("el-button-group"),b=s("el-table-column"),h=s("el-tag"),he=s("el-link"),we=s("View"),Ce=s("Edit"),J=s("MoreFilled"),k=s("el-dropdown-item"),K=s("el-dropdown-menu"),Q=s("el-dropdown"),ke=s("el-table"),xe=s("Calendar"),Te=s("Location"),Me=s("User"),ze=s("el-pagination"),Ve=s("el-dialog"),X=Le("loading");return f(),B("div",Ne,[n("div",Re,[e[12]||(e[12]=n("div",{class:"header-left"},[n("h1",null,"会议管理"),n("p",null,"管理和组织各类会议活动")],-1)),n("div",Ee,[t(m,{type:"primary",onClick:se},{default:l(()=>[t(u,null,{default:l(()=>[t(g)]),_:1}),e[11]||(e[11]=i(" 创建会议 "))]),_:1,__:[11]})])]),t(q,{class:"search-card",shadow:"never"},{default:l(()=>[t(ge,{model:p,inline:"",class:"search-form"},{default:l(()=>[t(D,{label:"会议标题"},{default:l(()=>[t(_e,{modelValue:p.title,"onUpdate:modelValue":e[0]||(e[0]=a=>p.title=a),placeholder:"请输入会议标题",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),t(D,{label:"会议类型"},{default:l(()=>[t(W,{modelValue:p.type,"onUpdate:modelValue":e[1]||(e[1]=a=>p.type=a),placeholder:"请选择会议类型",clearable:"",style:{width:"150px"}},{default:l(()=>[t(C,{label:"技术交流",value:1}),t(C,{label:"产品发布",value:2}),t(C,{label:"培训课程",value:3}),t(C,{label:"其他",value:4})]),_:1},8,["modelValue"])]),_:1}),t(D,{label:"会议状态"},{default:l(()=>[t(W,{modelValue:p.status,"onUpdate:modelValue":e[2]||(e[2]=a=>p.status=a),placeholder:"请选择会议状态",clearable:"",style:{width:"150px"}},{default:l(()=>[t(C,{label:"草稿",value:0}),t(C,{label:"已发布",value:1}),t(C,{label:"已取消",value:2})]),_:1},8,["modelValue"])]),_:1}),t(D,{label:"开始时间"},{default:l(()=>[t(me,{modelValue:p.dateRange,"onUpdate:modelValue":e[3]||(e[3]=a=>p.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),t(D,null,{default:l(()=>[t(m,{type:"primary",onClick:te},{default:l(()=>[t(u,null,{default:l(()=>[t(fe)]),_:1}),e[13]||(e[13]=i(" 搜索 "))]),_:1,__:[13]}),t(m,{onClick:le},{default:l(()=>[t(u,null,{default:l(()=>[t(ve)]),_:1}),e[14]||(e[14]=i(" 重置 "))]),_:1,__:[14]})]),_:1})]),_:1},8,["model"])]),_:1}),t(q,{class:"table-card",shadow:"never"},{default:l(()=>[n("div",Pe,[n("div",Fe,[e[15]||(e[15]=n("h3",null,"会议列表",-1)),n("span",je,"共 "+d(R.value)+" 条记录",1)]),n("div",Ae,[t(H,null,{default:l(()=>[t(m,{type:T.value==="table"?"primary":"",onClick:e[4]||(e[4]=a=>T.value="table")},{default:l(()=>[t(u,null,{default:l(()=>[t(ye)]),_:1}),e[16]||(e[16]=i(" 列表视图 "))]),_:1,__:[16]},8,["type"]),t(m,{type:T.value==="card"?"primary":"",onClick:e[5]||(e[5]=a=>T.value="card")},{default:l(()=>[t(u,null,{default:l(()=>[t(be)]),_:1}),e[17]||(e[17]=i(" 卡片视图 "))]),_:1,__:[17]},8,["type"])]),_:1})])]),T.value==="table"?Z((f(),M(ke,{key:0,data:V.value,stripe:"",style:{width:"100%"},onSelectionChange:oe},{default:l(()=>[t(b,{type:"selection",width:"55"}),t(b,{prop:"title",label:"会议标题","min-width":"200"},{default:l(({row:a})=>[n("div",Ie,[n("h4",null,d(a.title),1),a.isTop?(f(),M(h,{key:0,type:"danger",size:"small"},{default:l(()=>e[18]||(e[18]=[i("置顶")])),_:1,__:[18]})):w("",!0)])]),_:1}),t(b,{prop:"type",label:"会议类型",width:"120"},{default:l(({row:a})=>[t(h,{type:P(a.tags)},{default:l(()=>[i(d(F(a.tags)),1)]),_:2},1032,["type"])]),_:1}),t(b,{prop:"startTime",label:"开始时间",width:"180"},{default:l(({row:a})=>[i(d($(a.startTime)),1)]),_:1}),t(b,{prop:"location",label:"会议地点","min-width":"150"}),t(b,{prop:"currentParticipants",label:"报名人数",width:"100",align:"center"},{default:l(({row:a})=>[t(he,{type:"primary",onClick:x=>ie(a.id)},{default:l(()=>[i(d(a.currentParticipants||0)+"人 ",1)]),_:2},1032,["onClick"])]),_:1}),t(b,{prop:"status",label:"状态",width:"100"},{default:l(({row:a})=>[t(h,{type:j(a.status)},{default:l(()=>[i(d(A(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(b,{prop:"creatorName",label:"创建人",width:"120"}),t(b,{label:"操作",width:"200",fixed:"right"},{default:l(({row:a})=>[t(H,null,{default:l(()=>[t(m,{size:"small",onClick:x=>I(a.id)},{default:l(()=>[t(u,null,{default:l(()=>[t(we)]),_:1})]),_:2},1032,["onClick"]),t(m,{size:"small",onClick:x=>E(a.id)},{default:l(()=>[t(u,null,{default:l(()=>[t(Ce)]),_:1})]),_:2},1032,["onClick"]),t(Q,{onCommand:x=>G(x,a)},{dropdown:l(()=>[t(K,null,{default:l(()=>[a.status===0?(f(),M(k,{key:0,command:"publish",icon:"Upload"},{default:l(()=>e[19]||(e[19]=[i(" 发布 ")])),_:1,__:[19]})):w("",!0),a.status===1?(f(),M(k,{key:1,command:"cancel",icon:"Close"},{default:l(()=>e[20]||(e[20]=[i(" 取消 ")])),_:1,__:[20]})):w("",!0),t(k,{command:a.isTop===1?"untop":"top",icon:"Top"},{default:l(()=>[i(d(a.isTop?"取消置顶":"置顶"),1)]),_:2},1032,["command"]),t(k,{command:"copy",icon:"CopyDocument"},{default:l(()=>e[21]||(e[21]=[i(" 复制 ")])),_:1,__:[21]}),t(k,{command:"delete",icon:"Delete",divided:""},{default:l(()=>e[22]||(e[22]=[i(" 删除 ")])),_:1,__:[22]})]),_:2},1024)]),default:l(()=>[t(m,{size:"small"},{default:l(()=>[t(u,null,{default:l(()=>[t(J)]),_:1})]),_:1})]),_:2},1032,["onCommand"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[X,L.value]]):w("",!0),T.value==="card"?Z((f(),B("div",Ge,[n("div",Oe,[(f(!0),B(Se,null,Ue(V.value,a=>(f(),B("div",{key:a.id,class:"meeting-card",onClick:x=>I(a.id)},[n("div",qe,[n("div",He,[t(h,{type:P(a.type),size:"small"},{default:l(()=>[i(d(F(a.type)),1)]),_:2},1032,["type"])]),n("div",Je,[t(Q,{onCommand:x=>G(x,a)},{dropdown:l(()=>[t(K,null,{default:l(()=>[t(k,{command:"edit",icon:"Edit"},{default:l(()=>e[23]||(e[23]=[i("编辑")])),_:1,__:[23]}),t(k,{command:"delete",icon:"Delete"},{default:l(()=>e[24]||(e[24]=[i("删除")])),_:1,__:[24]})]),_:1})]),default:l(()=>[t(m,{size:"small",text:""},{default:l(()=>[t(u,null,{default:l(()=>[t(J)]),_:1})]),_:1})]),_:2},1032,["onCommand"])])]),n("div",Ke,[n("h3",Qe,[i(d(a.title)+" ",1),a.isTop?(f(),M(h,{key:0,type:"danger",size:"small"},{default:l(()=>e[25]||(e[25]=[i("置顶")])),_:1,__:[25]})):w("",!0)]),n("div",Xe,[n("div",Ye,[t(u,null,{default:l(()=>[t(xe)]),_:1}),n("span",null,d($(a.startTime)),1)]),n("div",Ze,[t(u,null,{default:l(()=>[t(Te)]),_:1}),n("span",null,d(a.location),1)]),n("div",et,[t(u,null,{default:l(()=>[t(Me)]),_:1}),n("span",null,d(a.registrationCount||0)+"人报名",1)])]),n("div",tt,d(a.description||"暂无描述"),1)]),n("div",lt,[n("div",nt,[t(h,{type:j(a.status)},{default:l(()=>[i(d(A(a.status)),1)]),_:2},1032,["type"])]),n("div",at,[n("span",null,d(a.creatorName),1)])])],8,We))),128))])])),[[X,L.value]]):w("",!0),n("div",ot,[t(ze,{"current-page":_.page,"onUpdate:currentPage":e[6]||(e[6]=a=>_.page=a),"page-size":_.size,"onUpdate:pageSize":e[7]||(e[7]=a=>_.size=a),"page-sizes":[10,20,50,100],total:R.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ne,onCurrentChange:ae},null,8,["current-page","page-size","total"])])]),_:1}),t(Ve,{modelValue:z.value,"onUpdate:modelValue":e[10]||(e[10]=a=>z.value=a),title:"会议详情",width:"800px","before-close":pe},{footer:l(()=>[n("div",Ct,[t(m,{onClick:e[8]||(e[8]=a=>z.value=!1)},{default:l(()=>e[36]||(e[36]=[i("关闭")])),_:1,__:[36]}),t(m,{type:"primary",onClick:e[9]||(e[9]=a=>E(r.value.id))},{default:l(()=>e[37]||(e[37]=[i(" 编辑会议 ")])),_:1,__:[37]})])]),default:l(()=>[r.value?(f(),B("div",st,[n("div",it,[n("h2",null,d(r.value.title),1),n("div",dt,[t(h,{type:P(r.value.type)},{default:l(()=>[i(d(F(r.value.type)),1)]),_:1},8,["type"]),t(h,{type:j(r.value.status)},{default:l(()=>[i(d(A(r.value.status)),1)]),_:1},8,["type"]),r.value.isTop?(f(),M(h,{key:0,type:"danger"},{default:l(()=>e[26]||(e[26]=[i("置顶")])),_:1,__:[26]})):w("",!0)])]),n("div",rt,[n("div",ut,[e[33]||(e[33]=n("h3",null,"基本信息",-1)),n("div",ct,[n("div",pt,[e[27]||(e[27]=n("label",null,"开始时间：",-1)),n("span",null,d($(r.value.startTime)),1)]),n("div",_t,[e[28]||(e[28]=n("label",null,"结束时间：",-1)),n("span",null,d($(r.value.endTime)),1)]),n("div",mt,[e[29]||(e[29]=n("label",null,"会议地点：",-1)),n("span",null,d(r.value.location),1)]),n("div",ft,[e[30]||(e[30]=n("label",null,"报名截止：",-1)),n("span",null,d($(r.value.registrationDeadline)),1)]),n("div",vt,[e[31]||(e[31]=n("label",null,"最大人数：",-1)),n("span",null,d(r.value.maxParticipants||"不限"),1)]),n("div",gt,[e[32]||(e[32]=n("label",null,"报名人数：",-1)),n("span",null,d(r.value.registrationCount||0)+"人",1)])])]),n("div",yt,[e[34]||(e[34]=n("h3",null,"会议描述",-1)),n("div",bt,d(r.value.description||"暂无描述"),1)]),n("div",ht,[e[35]||(e[35]=n("h3",null,"会议议程",-1)),n("div",wt,d(r.value.agenda||"暂无议程"),1)])])])):w("",!0)]),_:1},8,["modelValue"])])}}},zt=$e(kt,[["__scopeId","data-v-7ce9da9c"]]);export{zt as default};
