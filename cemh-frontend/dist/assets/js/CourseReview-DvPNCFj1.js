import{_ as E,a4 as j,S as Q,U as W,c as U,b as d,g as G,A as t,f as u,p as r,z as n,W as H,m as D,u as J,r as I,a as g,o as K,E as k,j as O,k as f,t as V,C as A}from"./index-Ntw4s37F.js";import{c as T}from"./course-DBRud_bH.js";const X={name:"CourseReview",components:{Search:W,Refresh:Q,Reading:j},setup(){const N=O(),e=J(),m=I({page:1,size:10,courseName:"",courseAuthor:"",remark:"1"}),o=g([]),S=g(0),C=g(!1),w=g(!1),v=g(null),s=I({status:0,reviewComment:""}),i=g(!1),c=async()=>{C.value=!0;try{const l=await T.getCourseList(m,e.getTenantId);o.value=l.data.records||[],S.value=l.data.total||0}catch(l){console.error("获取课程列表失败:",l),k.error("获取课程列表失败")}finally{C.value=!1}},y=()=>{m.page=1,c()},R=()=>{m.courseName="",m.courseAuthor="",m.remark="1",y()},p=l=>{m.size=l,c()},x=l=>{m.page=l,c()},b=l=>{N.push({path:`/dashboard/course-detail/${l.id}`})},_=l=>{v.value=l,s.status=0,s.reviewComment="",w.value=!0},z=async()=>{if(s.status===2&&!s.reviewComment){k.warning("审核不通过时，请填写审核意见");return}i.value=!0;try{await T.reviewCourse(v.value.id,s,e.getTenantId,e.getUserId),k.success("审核提交成功"),w.value=!1,c()}catch(l){console.error("审核提交失败:",l),k.error("审核提交失败")}finally{i.value=!1}},P=l=>({0:"审核通过",1:"待审核",2:"审核不通过"})[l]||"未知状态",q=l=>({0:"success",1:"warning",2:"danger"})[l]||"info";return K(()=>{c()}),{queryParams:m,courseList:o,total:S,loading:C,reviewDialogVisible:w,currentCourse:v,reviewForm:s,reviewSubmitting:i,handleSearch:y,resetQuery:R,handleSizeChange:p,handleCurrentChange:x,viewCourseDetails:b,handleReview:_,submitReview:z,getReviewStatusText:P,getReviewStatusType:q}}},Y={class:"course-review"},Z={class:"page-header"},$={class:"header-content"},ee={class:"page-title"},oe={class:"search-container"},te={key:1},re={class:"pagination-container"},ae={key:0,class:"review-course-info"},le={class:"dialog-footer"};function ne(N,e,m,o,S,C){const w=n("Reading"),v=n("el-icon"),s=n("el-input"),i=n("el-form-item"),c=n("el-option"),y=n("el-select"),R=n("Search"),p=n("el-button"),x=n("Refresh"),b=n("el-form"),_=n("el-table-column"),z=n("el-image"),P=n("el-tag"),q=n("el-table"),l=n("el-pagination"),h=n("el-radio"),F=n("el-radio-group"),M=n("el-dialog"),B=H("loading");return f(),U("div",Y,[d("div",Z,[d("div",$,[d("h1",ee,[t(v,null,{default:r(()=>[t(w)]),_:1}),e[9]||(e[9]=u(" 课程审核管理 "))]),e[10]||(e[10]=d("p",{class:"page-description"},"管理待审核的课程内容，进行课程审核操作",-1))])]),d("div",oe,[t(b,{inline:!0,model:o.queryParams,class:"search-form"},{default:r(()=>[t(i,{label:"课程名称"},{default:r(()=>[t(s,{modelValue:o.queryParams.courseName,"onUpdate:modelValue":e[0]||(e[0]=a=>o.queryParams.courseName=a),placeholder:"请输入课程名称",clearable:""},null,8,["modelValue"])]),_:1}),t(i,{label:"课程作者"},{default:r(()=>[t(s,{modelValue:o.queryParams.courseAuthor,"onUpdate:modelValue":e[1]||(e[1]=a=>o.queryParams.courseAuthor=a),placeholder:"请输入课程作者",clearable:""},null,8,["modelValue"])]),_:1}),t(i,{label:"审核状态"},{default:r(()=>[t(y,{modelValue:o.queryParams.remark,"onUpdate:modelValue":e[2]||(e[2]=a=>o.queryParams.remark=a),placeholder:"请选择审核状态",clearable:""},{default:r(()=>[t(c,{label:"未审核",value:"1"}),t(c,{label:"审核通过",value:"0"}),t(c,{label:"审核失败",value:"2"})]),_:1},8,["modelValue"])]),_:1}),t(i,null,{default:r(()=>[t(p,{type:"primary",onClick:o.handleSearch},{default:r(()=>[t(v,null,{default:r(()=>[t(R)]),_:1}),e[11]||(e[11]=u("搜索 "))]),_:1,__:[11]},8,["onClick"]),t(p,{onClick:o.resetQuery},{default:r(()=>[t(v,null,{default:r(()=>[t(x)]),_:1}),e[12]||(e[12]=u("重置 "))]),_:1,__:[12]},8,["onClick"])]),_:1})]),_:1},8,["model"])]),G((f(),D(q,{data:o.courseList,border:"",style:{width:"100%"},"row-key":"id"},{default:r(()=>[t(_,{prop:"id",label:"ID",width:"80"}),t(_,{prop:"courseName",label:"课程名称","min-width":"150","show-overflow-tooltip":""}),t(_,{label:"课程封面",width:"100"},{default:r(a=>[a.row.coverImage?(f(),D(z,{key:0,src:a.row.coverImage,"preview-src-list":[a.row.coverImage],"preview-teleported":!0,"z-index":3e3,fit:"cover",style:{width:"60px",height:"40px","border-radius":"4px",cursor:"pointer"}},null,8,["src","preview-src-list"])):(f(),U("span",te,"无封面"))]),_:1}),t(_,{prop:"courseAuthor",label:"课程作者",width:"120","show-overflow-tooltip":""}),t(_,{prop:"remark",label:"审核状态",width:"100",align:"center"},{default:r(a=>[t(P,{type:o.getReviewStatusType(a.row.remark)},{default:r(()=>[u(V(o.getReviewStatusText(a.row.remark)),1)]),_:2},1032,["type"])]),_:1}),t(_,{prop:"createTime",label:"创建时间",width:"160","show-overflow-tooltip":""}),t(_,{label:"操作",width:"200",align:"center",fixed:"right"},{default:r(a=>[a.row.remark==="1"?(f(),D(p,{key:0,type:"success",link:"",onClick:L=>o.handleReview(a.row)},{default:r(()=>e[13]||(e[13]=[u("审核")])),_:2,__:[13]},1032,["onClick"])):A("",!0),t(p,{type:"primary",link:"",onClick:L=>o.viewCourseDetails(a.row)},{default:r(()=>e[14]||(e[14]=[u("查看")])),_:2,__:[14]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[B,o.loading]]),d("div",re,[t(l,{"current-page":o.queryParams.page,"onUpdate:currentPage":e[3]||(e[3]=a=>o.queryParams.page=a),"page-size":o.queryParams.size,"onUpdate:pageSize":e[4]||(e[4]=a=>o.queryParams.size=a),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:o.handleSizeChange,onCurrentChange:o.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),t(M,{title:"课程审核",modelValue:o.reviewDialogVisible,"onUpdate:modelValue":e[8]||(e[8]=a=>o.reviewDialogVisible=a),width:"600px","close-on-click-modal":!1,"destroy-on-close":""},{footer:r(()=>[d("div",le,[t(p,{onClick:e[7]||(e[7]=a=>o.reviewDialogVisible=!1)},{default:r(()=>e[17]||(e[17]=[u("取消")])),_:1,__:[17]}),t(p,{type:"primary",onClick:o.submitReview,loading:o.reviewSubmitting},{default:r(()=>e[18]||(e[18]=[u("确认")])),_:1,__:[18]},8,["onClick","loading"])])]),default:r(()=>[o.currentCourse?(f(),U("div",ae,[d("h3",null,V(o.currentCourse.courseName),1),d("p",null,"作者："+V(o.currentCourse.courseAuthor),1),d("p",null,"简介："+V(o.currentCourse.courseIntro),1)])):A("",!0),t(b,{ref:"reviewFormRef",model:o.reviewForm,"label-width":"100px"},{default:r(()=>[t(i,{label:"审核结果",prop:"status"},{default:r(()=>[t(F,{modelValue:o.reviewForm.status,"onUpdate:modelValue":e[5]||(e[5]=a=>o.reviewForm.status=a)},{default:r(()=>[t(h,{label:0},{default:r(()=>e[15]||(e[15]=[u("通过")])),_:1,__:[15]}),t(h,{label:2},{default:r(()=>e[16]||(e[16]=[u("不通过")])),_:1,__:[16]})]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"审核意见",prop:"reviewComment"},{default:r(()=>[t(s,{modelValue:o.reviewForm.reviewComment,"onUpdate:modelValue":e[6]||(e[6]=a=>o.reviewForm.reviewComment=a),type:"textarea",rows:"4",placeholder:"请输入审核意见（不通过时必填）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const de=E(X,[["render",ne],["__scopeId","data-v-50dc6e39"]]);export{de as default};
